{% extends "base.html" %}
{% block titleprefix %}{% if work.anonymous %}#{{ work.id }} {{ work.title }} by anonymous{% else %}#{{ work.id }} {{ work.title }} by {{ work.user.name }}{% endif %}{% endblock %}
{% block extra_head %}
{% endblock %}
{% block main %}
<main>
	<h2>{{work.title}}</h2>
	<form action="{{ url_for(".work_update", id=work.id) }}" method="POST">
		<table>
			<tr>
				<th colspan=2>Work Information</th>
			</tr>
			<tr>
				<th scope="row">ID</th>
				<td>{{ work.id }}</td>
			</tr>
			{% if (not work.anonymous) or (work.user.oid == user.oid) %}
			<tr>
				<th scope="row">Author</th>
				<td><a href="{{ url_for(".user", oid=work.user.oid) }}">{{ work.user.name }}</a></td>
			</tr>
			{% endif %}
			<tr>
				<th scope="row">Flags</th>
				<td>
					<input id="flag-public" type="checkbox" name="public" {% if work.user.oid != user.oid %}disabled{% endif %} {% if work.public %}checked{% endif %}><label for="flag-public">Public</label>
					<input id="flag-active" type="checkbox" name="active" {% if work.user.oid != user.oid %}disabled{% endif %} {% if work.active %}checked{% endif %}><label for="flag-active">Active</label>
					<input id="flag-anonymous" type="checkbox" name="anonymous" {% if work.user.oid != user.oid %}disabled{% endif %} {% if work.anonymous %}checked{% endif %}><label for="flag-anonymous">Anonymous</label>
				</td>
			</tr>
			<tr>
				<th scope="row">File</th>
				{% if work.filename %}
				<td><a class="filename" href="{{url_for(".file", filename=work.filename)}}">{{ work.filename }}</a></td>
				{% else %}
				<td>None</td>
				{% endif %}
			</tr>
		</table>
	</form>
	<div id="main-actions">
		<a class="btn btn-normal" href="{{ url_for(".work_comment_new", wid=work.id) }}">Create a whole-work comment</a>
	</div>
	{% if not work.text %}
	<p>
	This work has no raw text. Check the file.
	</p>
	{% else %}
	<article class="work-text">{{ work.text }}</article>
	{% endif %}
</main>
{% endblock %}
{% block final_script %}
{% endblock %}
